FROM golang:latest as builder

RUN go get -v github.com/fasthttp/router \
       	      github.com/valyala/fasthttp \
	      github.com/AubSs/fasthttplogger \
	      go.mongodb.org/mongo-driver/mongo

WORKDIR /build_dir
COPY . .

RUN go build -v -o bin .

FROM alpine:latest

RUN apk add --no-cache libc6-compat

WORKDIR /api
COPY --from=builder /build_dir/bin .

EXPOSE 8080
ENTRYPOINT /api/bin